import{GraphQLError as e,Kind as t,parse as r,print as n}from"graphql";import{make as o}from"wonka";const s=t=>"string"==typeof t?new e(t):"object"==typeof t&&t.message?new e(t.message,t.nodes,t.source,t.positions,t.path,t,t.extensions||{}):t;class a extends Error{constructor(e){const t=(e.graphQLErrors||[]).map(s),r=((e,t)=>{let r="";if(e)return`[Network] ${e.message}`;if(t)for(const e of t)r&&(r+="\n"),r+=`[GraphQL] ${e.message}`;return r})(e.networkError,t);super(r),this.name="CombinedError",this.message=r,this.graphQLErrors=t,this.networkError=e.networkError,this.response=e.response}toString(){return this.message}}const i=(e,t)=>{for(let r=0,n=0|t.length;r<n;r++)e=(e<<5)+e+t.charCodeAt(r);return 0|e},c=e=>i(5381,e)>>>0,l=new Set,f=new WeakMap,u=e=>{if(null===e||l.has(e))return"null";if("object"!=typeof e)return JSON.stringify(e)||"";if(e.toJSON)return u(e.toJSON());if(Array.isArray(e)){let t="[";for(let r of e)"["!==t&&(t+=","),r=u(r),t+=r.length>0?r:"null";return t+="]",t}const t=Object.keys(e).sort();if(!t.length&&e.constructor&&e.constructor!==Object){const t=f.get(e)||Math.random().toString(36).slice(2);return f.set(e,t),`{"__key":"${t}"}`}l.add(e);let r="{";for(const n of t){const t=u(e[n]);t&&(r.length>1&&(r+=","),r+=u(n)+":"+t)}return l.delete(e),r+="}",r},d=e=>(l.clear(),u(e)),p=/("{3}[\s\S]*"{3}|"(?:\\.|[^"])*")/g,h=/([\s,]|#[^\n\r]+)+/g,y=(e,t)=>t%2==0?e.replace(h," ").trim():e,g=e=>{let t=("string"!=typeof e?e.loc&&e.loc.source.body||n(e):e).split(p).map(y).join("");if("string"!=typeof e){const r="definitions"in e&&w(e);r&&(t=`# ${r}\n${t}`),e.loc||(e.loc={start:0,end:t.length,source:{body:t,name:"gql",locationOffset:{line:1,column:1}}})}return t},x=new Map,m=e=>{let t,n;return"string"==typeof e?(t=c(g(e)),n=x.get(t)||r(e,{noLocation:!0})):(t=e.__key||c(g(e)),n=x.get(t)||e),n.loc||g(n),n.__key=t,x.set(t,n),n},b=(e,t)=>{t||(t={});const r=m(e);return{key:i(r.__key,d(t))>>>0,query:r,variables:t}},w=e=>{for(const r of e.definitions)if(r.kind===t.OPERATION_DEFINITION&&r.name)return r.name.value},O=e=>{for(const r of e.definitions)if(r.kind===t.OPERATION_DEFINITION)return r.operation},N=(e,t,r)=>{if(!("data"in t)&&!("errors"in t)||"path"in t)throw new Error("No Content");return{operation:e,data:t.data,error:Array.isArray(t.errors)?new a({graphQLErrors:t.errors,response:r}):void 0,extensions:"object"==typeof t.extensions&&t.extensions||void 0,hasNext:!!t.hasNext}},E=(e,t,r)=>{const n={...e};if(n.hasNext=!!t.hasNext,!("path"in t))return"data"in t&&(n.data=t.data),n;Array.isArray(t.errors)&&(n.error=new a({graphQLErrors:n.error?[...n.error.graphQLErrors,...t.errors]:t.errors,response:r}));let o,s=n.data={...n.data},i=0;for(;i<t.path.length;)o=t.path[i++],s=s[o]=Array.isArray(s[o])?[...s[o]]:{...s[o]};return Object.assign(s,t.data),n},k=(e,t,r)=>({operation:e,data:void 0,error:new a({networkError:t,response:r}),extensions:void 0});function v(e){return{query:n(e.query),operationName:w(e.query),variables:e.variables||void 0,extensions:void 0}}const S=(e,t)=>{if("query"!==e.kind||!e.context.preferGetMethod||!t)return e.context.url;const r=new URL(e.context.url),n=r.searchParams;t.operationName&&n.set("operationName",t.operationName),t.query&&n.set("query",t.query.replace(/#[^\n\r]+/g," ").trim()),t.variables&&n.set("variables",d(t.variables)),t.extensions&&n.set("extensions",d(t.extensions));const o=r.toString();return o.length>2047?(e.context.preferGetMethod=!1,e.context.url):o},q=(e,t)=>{const r="query"===e.kind&&!!e.context.preferGetMethod,n={accept:"application/graphql+json, application/json"};r||(n["content-type"]="application/json");const o=("function"==typeof e.context.fetchOptions?e.context.fetchOptions():e.context.fetchOptions)||{};if(o.headers)for(const e in o.headers)n[e.toLowerCase()]=o.headers[e];return{...o,body:!r&&t?JSON.stringify(t):void 0,method:r?"GET":"POST",headers:n}},A="undefined"!=typeof TextDecoder?new TextDecoder:null,j=/content-type:[^\r\n]*application\/json/i,T=/boundary="?([^=";]+)"?/i,I=(e,t,r)=>{const n="manual"===r.redirect?400:300,s=e.context.fetch;return o((({next:o,complete:a})=>{const i="undefined"!=typeof AbortController?new AbortController:null;i&&(r.signal=i.signal);let c,l=!1,f=!1,u=!1;return Promise.resolve().then((()=>{if(!f)return(s||fetch)(t,r)})).then((t=>{if(t)return c=t,u=c.status<200||c.status>=n,((e,t,r)=>{const n=r.headers&&r.headers.get("Content-Type")||"";if(/text\//i.test(n))return r.text().then((n=>{e(k(t,new Error(n),r))}));if(!/multipart\/mixed/i.test(n))return r.text().then((n=>{e(N(t,JSON.parse(n),r))}));let o="---";const s=n.match(T);let a;s&&(o="--"+s[1]);let i=()=>{};if(r[Symbol.asyncIterator]){const e=r[Symbol.asyncIterator]();a=e.next.bind(e)}else{if(!("body"in r)||!r.body)throw new TypeError("Streaming requests unsupported");{const e=r.body.getReader();i=()=>e.cancel(),a=()=>e.read()}}let c="",f=!0,u=null,d=null;return a().then((function n(s){if(s.done)l=!0;else{const n="Buffer"===(i=s.value).constructor.name?i.toString():A.decode(i);let a=n.indexOf(o);for(a>-1?a+=c.length:a=c.indexOf(o),c+=n;a>-1;){const n=c.slice(0,a),s=c.slice(a+o.length);if(f)f=!1;else{const o=n.indexOf("\r\n\r\n")+4,a=n.slice(0,o),i=n.slice(o,n.lastIndexOf("\r\n"));let c;if(j.test(a))try{c=JSON.parse(i),u=d=d?E(d,c,r):N(t,c,r)}catch(e){}if("--"===s.slice(0,2)||c&&!c.hasNext){if(!d)return e(N(t,{},r));break}}c=s,a=c.indexOf(o)}}var i;if(u&&(e(u),u=null),!s.done&&(!d||d.hasNext))return a().then(n)})).finally(i)})(o,e,c)})).then(a).catch((t=>{if(l)throw t;const r=k(e,u&&c.statusText?new Error(c.statusText):t,c);o(r),a()})),()=>{f=!0,i&&i.abort()}}))};export{a as C,k as a,v as b,S as c,q as d,I as e,b as f,O as g,d as h,E as i,w as j,m as k,N as m,g as s};
//# sourceMappingURL=4d037e29.min.mjs.map
